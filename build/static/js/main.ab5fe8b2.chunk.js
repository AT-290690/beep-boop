(this["webpackJsonpbleep-bloop"]=this["webpackJsonpbleep-bloop"]||[]).push([[0],{16:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var c=n(4),a=n.n(c),i=n(10),o=n.n(i),u=(n(16),n(2)),s=n(1),l=n(8),r="0.1",b=100,j=new l.a(l.b,{envelope:{releaseCurve:"sine"}}).toDestination();l.c.lookAhead=.2;for(var f=function(){for(var e=window.setTimeout((function(){}),0);e--;)window.clearTimeout(e)},d=new Map,h=[],m=0;m<7;m++){var O=document.getElementById("switch".concat(m));O.volume=.3,h.push(O)}var v=function(e){var t=h[e];t&&(t.currentTime=0,t.play())},p=["A0","B0","C1","D1","E1","F1","G1","A1","B1","C2","D2","E2","F2","G2","A2","B2","C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","B4","C5","D5","E5","F5","G5","A5","B5","C6","A6","B6","C7","D7","E7","F7","G7","A7","B7","B8"],y=n(11),x=n(3),g=function(e){var t=e.i,n=e.j,a=e.note,i=e.sound,o=e.sheet,u=e.mod,l=e.volume,b=e.speed,j="".concat(t,":").concat(n),f=o[j]||null,h=f?o[j]:{delay:.1,x:t,y:n},m=h.delay,O=h.delay>.1?h.delay+1:1,v=Object(c.useState)(f?"1":r),p=Object(s.a)(v,2),y=p[0],g=p[1],C=Object(c.useState)("#"+function(e){var t=(16777215&e).toString(16).toUpperCase();return"000000".substring(0,6-t.length)+t}(function(e){for(var t=0,n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return t}(a+"1230"))),S=Object(s.a)(C,1)[0];return f&&(o[j]=h,o[j].value=a),Object(x.jsx)("button",{style:{opacity:y},ref:function(e){t<u&&d.set(j,e)},className:"note-button",id:j,title:a,onClick:function(){var e="".concat(t,":").concat(n);o[e]?(g(r),delete o[e]):(g("1"),i.volume.value=l-30,i.triggerAttackRelease(a,m*b),o[e]={value:a,delay:m,x:t,y:n})},children:Object(x.jsx)("div",{style:{transform:"scale(1, ".concat(O,")"),backgroundColor:S},className:"shape"})})},C=function(){var e=Object(c.useState)(15),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Object(c.useState)(30),o=Object(s.a)(i,2),l=o[0],m=o[1],O=Object(c.useState)(15),C=Object(s.a)(O,2),S=C[0],w=C[1],N=Object(c.useState)(0),A=Object(s.a)(N,2),k=A[0],E=A[1],B=Object(c.useState)(30),T=Object(s.a)(B,2),M=T[0],z=T[1],D=Object(c.useState)(p),F=Object(s.a)(D,1)[0],G=Object(c.useState)(.25),H=Object(s.a)(G,2),J=H[0],L=H[1],I=Object(c.useState)(0),q=Object(s.a)(I,2),R=q[0],K=q[1],P=Object(c.useState)(15),U=Object(s.a)(P,2),W=U[0],Q=U[1],V=Object(c.useState)({}),X=Object(s.a)(V,2),Y=X[0],Z=X[1],$=Object(c.useState)(!0),_=Object(s.a)($,2),ee=_[0],te=_[1],ne=Object(c.useState)(!1),ce=Object(s.a)(ne,2),ae=ce[0],ie=ce[1],oe=Object(c.useState)(""),ue=Object(s.a)(oe,2),se=ue[0],le=ue[1],re=Object(c.useState)(!1),be=Object(s.a)(re,2),je=be[0],fe=be[1],de=Object(c.useState)(),he=Object(s.a)(de,2),me=he[0],Oe=he[1],ve=Object(c.useState)(!1),pe=Object(s.a)(ve,2),ye=pe[0],xe=pe[1],ge=function(e){var t=Object(c.useState)(e),n=Object(s.a)(t,2),a=n[0],i=n[1];return Object(c.useLayoutEffect)((function(){var e=function(){i({w:Math.floor(window.innerWidth/50),h:Math.floor(window.innerHeight/45)})};return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),a}({w:l,h:n});Object(c.useEffect)((function(){ie(!1),m(ge.w),a(ge.h),ie(!0)}),[ge.w,ge.h]),Object(c.useEffect)((function(){return ie(!0)}),[ee]);var Ce,Se,we,Ne=function(e){ke();var t=Math.floor(Object.values(e).reduce((function(e,t){return Math.max(e,t.x)}),0)/n);!function e(n){ie(!1),n<=t?(K(W*n),setTimeout((function(){return e(++n)}),150)):K(0),ie(!0)}(0)},Ae=function e(){var t=-1/0;setTimeout((function(){W!==n&&Q(n),f();for(var c=Object.values(Y).map((function(e){var c=e.x,a=e.y,i=d.get("".concat((c+R)%n,":").concat(a));return i&&(i.style.opacity=r,i.firstChild.style.transform="scale(1)"),t=Math.max(t,c),{note:e,element:i,index:c}})),a=0;a<t;a++)c[a]||(c[a]={note:null,element:null,index:a});le(JSON.stringify({sheet:Y,offset:S,speed:J,shift:k})),c.forEach((function(n){var c=n.note,a=n.element,i=n.index;return c&&setTimeout((function(){var n=c.value,o=c.delay;j.volume.value=M-30,j.triggerAttackRelease(n,Math.max(o*J,.1)),a&&(a.style.opacity="1"),setTimeout((function(){a&&setTimeout((function(){a.style.opacity=r,a.firstChild.style.transform="scale(1)"}),(J*o+1)*b+b),i===t&&setTimeout((function(){return e()}),1e3)}),(J*o+1)*b)}),J*i*1e3+200)}))}),b)},ke=function(){ie(!1),f(),te(!ee)};return Object(x.jsxs)("div",{children:[Object(x.jsxs)("div",{className:"options  ".concat(je?"blured":""),children:[Object(x.jsxs)("div",{className:"menu",children:[Object(x.jsx)("button",{className:"ui label",title:"shift right",onClick:function(){E(k+1),v(5)},children:">>"}),Object(x.jsx)("input",{className:"ui",onChange:function(e){E(+e.target.value||0)},title:"shift",value:k,min:-p.length,max:p.length,style:{width:25,textAlign:"center",fontSize:10}}),Object(x.jsx)("button",{className:"ui label",title:"shift left",onClick:function(){E(k-1),v(5)},children:"<<"}),Object(x.jsx)("input",{title:"offset",className:"ui",onChange:function(e){var t=+e.target.value;w(t),ie(!1),v(3),Ne(Y),te(!ee)},value:S,type:"number",min:0,max:p.length,style:{width:40,textAlign:"center",fontSize:10}}),Object(x.jsx)("input",{className:"ui",title:"change speed",onChange:function(e){return v(5)||L(+e.target.value)},step:"0.1",type:"number",style:{width:80,fontSize:10,textAlign:"center"},value:J}),Object(x.jsx)("input",{className:"ui",onChange:function(e){var t=+e.target.value;t>=0&&t<=100&&(!function(e){h.forEach((function(t){return t.volume=e/100})),z(e)}(t),v(5))},title:"volume",value:M,type:"number",min:0,max:100,style:{width:50,textAlign:"center",fontSize:10}}),Object(x.jsx)("button",{onClick:function(){v(1),xe(!1),y(document.querySelector(".matrix"),{backgroundColor:"transparent",canvas:me,onclone:function(e,t){var n,c=t.querySelectorAll(".note-button"),a=Object(u.a)(c);try{for(a.s();!(n=a.n()).done;){var i=n.value;i.style.opacity===r&&(i.style.opacity="0")}}catch(o){a.e(o)}finally{a.f()}}}).then((function(e){if(me)Oe(me);else{var t=document.getElementById("screenshotHandler");t.innerHTML="",t.appendChild(e)}xe(!0),v(3)}))},className:"ui label",children:"ghost"}),Object(x.jsx)("button",{onClick:function(){return xe(!ye)},className:"ui label",children:ye?"hide":"show"})]}),Object(x.jsxs)("div",{className:"tools",children:[Object(x.jsx)("button",{onClick:function(){0!==R&&(K(0),ie(!1),te(!ee)),Ae()},title:"play",className:"ui",children:">"}),Object(x.jsx)("button",{onClick:function(){ke(),v(1)},title:"stop",className:"ui",style:{fontSize:20},children:"#"}),Object(x.jsx)("button",{onClick:function(){R<=0||(ie(!1),K(R-W),te(!ee),v(4))},title:"up",className:"ui",children:"\u25b2"}),Object(x.jsx)("button",{title:"page",className:"ui",children:R/W}),Object(x.jsx)("button",{title:"down",onClick:function(e){ie(!1),K(W+R),te(!ee),v(4)},className:"ui",children:"\u25bc"}),Object(x.jsx)("button",{title:"erase",className:"ui",onClick:function(){return f(),Z({}),v(0),K(0),ie(!1),te(!ee),void history.replaceState({},null,"/")},children:"x"}),Object(x.jsx)("input",{onKeyPress:function(e){return"Enter"===e.key&&e.target.value.includes("sheet")?(t=JSON.parse(e.target.value),ie(!1),L(t.speed),w(t.offset),E(t.shift),Z(t.sheet),fe(!1),void Ne(t.sheet)):null;var t},title:"title",onChange:function(e){return le(e.target.value)},value:se,className:"ui title"})]})]}),Object(x.jsx)("div",{id:"screenshotHandler",style:{position:"absolute",display:ye?"block":"none"}}),ae&&Object(x.jsx)("div",{className:"matrix ".concat(je?"blured":""),style:{gridTemplateColumns:"auto ".repeat(l)},children:(Ce=n,Se=l,we=null,Array(Ce).fill(we).map((function(e){return Array(Se).fill(we)}))).map((function(e,t){return e.map((function(e,c){return Object(x.jsx)(g,{i:t+R,j:c-k,note:F[c-k+S],sound:j,sheet:Y,speed:J,mod:n,volume:M},t+"-"+(c-k))}))}))})]})},S=function(){return Object(x.jsx)("div",{className:"App",children:Object(x.jsx)(C,{})})};o.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(S,{})}),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.ab5fe8b2.chunk.js.map