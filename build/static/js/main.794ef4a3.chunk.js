(this["webpackJsonpbleep-bloop"]=this["webpackJsonpbleep-bloop"]||[]).push([[0],{16:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var a=n(4),c=n.n(a),i=n(10),s=n.n(i),o=(n(16),n(2)),u=n(1),l=n(8),r="0.1",b=100,j=new l.a(l.b,{envelope:{releaseCurve:"sine"}}).toDestination();l.c.lookAhead=.2;var f=function(){for(var e=window.setTimeout((function(){}),0);e--;)window.clearTimeout(e)},d=new Map,h=["A0","B0","C1","D1","E1","F1","G1","A1","B1","C2","D2","E2","F2","G2","A2","B2","C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","B4","C5","D5","E5","F5","G5","A5","B5","C6","A6","B6","C7","D7","E7","F7","G7","A7","B7","B8"],O=n(11),m=n(3),v=function(e){var t=e.i,n=e.j,c=e.note,i=e.sound,s=e.sheet,o=e.mod,l=e.volume,b=e.speed,j="".concat(t,":").concat(n),f=s[j]||null,h=f?s[j]:{delay:.1,x:t,y:n},O=h.delay,v=h.delay>.1?h.delay+1:1,p=Object(a.useState)(f?"1":r),y=Object(u.a)(p,2),x=y[0],g=y[1],C=Object(a.useState)("#"+function(e){var t=(16777215&e).toString(16).toUpperCase();return"000000".substring(0,6-t.length)+t}(function(e){for(var t=0,n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return t}(c+"1230"))),S=Object(u.a)(C,1)[0];return f&&(s[j]=h,s[j].value=c),Object(m.jsx)("button",{style:{opacity:x},ref:function(e){null!==e&&t<o&&d.set(j,e)},className:"note-button",id:j,title:c,onClick:function(){var e="".concat(t,":").concat(n);s[e]?(g(r),delete s[e]):(g("1"),i.volume.value=l-30,i.triggerAttackRelease(c,O*b),s[e]={value:c,delay:O,x:t,y:n})},children:Object(m.jsx)("div",{style:{transform:"scale(1, ".concat(v,")"),backgroundColor:S},className:"shape"})})},p=function(){var e=Object(a.useState)(15),t=Object(u.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(30),s=Object(u.a)(i,2),l=s[0],p=s[1],y=Object(a.useState)(15),x=Object(u.a)(y,2),g=x[0],C=x[1],S=Object(a.useState)(0),w=Object(u.a)(S,2),k=w[0],N=w[1],A=Object(a.useState)(30),E=Object(u.a)(A,2),B=E[0],T=E[1],M=Object(a.useState)(h),D=Object(u.a)(M,1)[0],z=Object(a.useState)(.25),F=Object(u.a)(z,2),G=F[0],J=F[1],L=Object(a.useState)(0),H=Object(u.a)(L,2),q=H[0],I=H[1],P=Object(a.useState)(15),R=Object(u.a)(P,2),K=R[0],U=R[1],W=Object(a.useState)({}),Q=Object(u.a)(W,2),V=Q[0],X=Q[1],Y=Object(a.useState)(!0),Z=Object(u.a)(Y,2),$=Z[0],_=Z[1],ee=Object(a.useState)(!1),te=Object(u.a)(ee,2),ne=te[0],ae=te[1],ce=Object(a.useState)(""),ie=Object(u.a)(ce,2),se=ie[0],oe=ie[1],ue=Object(a.useState)(!1),le=Object(u.a)(ue,2),re=le[0],be=le[1],je=Object(a.useState)(),fe=Object(u.a)(je,2),de=fe[0],he=fe[1],Oe=Object(a.useState)(!1),me=Object(u.a)(Oe,2),ve=me[0],pe=me[1],ye=function(e){var t=Object(a.useState)(e),n=Object(u.a)(t,2),c=n[0],i=n[1];return Object(a.useLayoutEffect)((function(){var e=function(){i({w:Math.floor(window.innerWidth/50),h:Math.floor(window.innerHeight/45)})};return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),c}({w:l,h:n});Object(a.useEffect)((function(){ae(!1),p(ye.w),c(ye.h),ae(!0)}),[ye.w,ye.h]),Object(a.useEffect)((function(){return ae(!0)}),[$]);var xe,ge,Ce,Se=function(e){ae(!1),J(e.speed),C(e.offset),N(e.shift),X(e.sheet),be(!1),we(e.sheet)},we=function(e){Ae();var t=Math.floor(Object.values(e).reduce((function(e,t){return Math.max(e,t.x)}),0)/n);!function e(n){ae(!1),n<=t?(I(K*n),setTimeout((function(){return e(++n)}),150)):I(0),ae(!0)}(0)},ke=function e(){var t=-1/0;setTimeout((function(){K!==n&&U(n),f();for(var a=Object.values(V).map((function(e){var a=e.x,c=e.y,i=d.get("".concat((a+q)%n,":").concat(c));return i&&(i.style.opacity=r,i.firstChild.style.transform="scale(1)"),t=Math.max(t,a),{note:e,element:i,index:a}})),c=0;c<t;c++)a[c]||(a[c]={note:null,element:null,index:c});oe(JSON.stringify({sheet:V,offset:g,speed:G,shift:k})),a.forEach((function(n){var a=n.note,c=n.element,i=n.index;return a&&setTimeout((function(){var n=a.value,s=a.delay;j.volume.value=B-30,j.triggerAttackRelease(n,Math.max(s*G,.1)),c&&(c.style.opacity="1"),setTimeout((function(){c&&setTimeout((function(){c.style.opacity=r,c.firstChild.style.transform="scale(1)"}),(G*s+1)*b+b),i===t&&setTimeout((function(){return e()}),1e3)}),(G*s+1)*b)}),G*i*1e3+200)}))}),b*(0===q?1:5))},Ne=function(){0!==q&&(I(0),ae(!1),_(!$)),ke()},Ae=function(){ae(!1),f(),_(!$)};return Object(m.jsxs)("div",{children:[Object(m.jsxs)("div",{className:"options  ".concat(re?"blured":""),children:[Object(m.jsxs)("div",{className:"menu",children:[Object(m.jsx)("button",{className:"ui label",title:"shift right",onClick:function(){N(k+1)},children:">>"}),Object(m.jsx)("input",{className:"ui",onChange:function(e){return N(+e.target.value||0)},title:"shift",value:k,min:-h.length,max:h.length,style:{width:25,textAlign:"center",fontSize:10}}),Object(m.jsx)("button",{className:"ui label",title:"shift left",onClick:function(){return N(k-1)},children:"<<"}),Object(m.jsx)("input",{title:"offset",className:"ui",onChange:function(e){var t=+e.target.value;C(t),ae(!1),we(V),_(!$)},value:g,type:"number",min:0,max:h.length,style:{width:40,textAlign:"center",fontSize:10}}),Object(m.jsx)("input",{className:"ui",title:"change speed",onChange:function(e){return J(+e.target.value)},step:"0.1",type:"number",style:{width:80,fontSize:10,textAlign:"center"},value:G}),Object(m.jsx)("input",{className:"ui",onChange:function(e){var t=+e.target.value;t>=0&&t<=100&&function(e){T(e)}(t)},title:"volume",value:B,type:"number",min:0,max:100,style:{width:50,textAlign:"center",fontSize:10}}),Object(m.jsx)("button",{onClick:function(){pe(!1),O(document.querySelector(".matrix"),{backgroundColor:"transparent",canvas:de,onclone:function(e,t){var n,a=t.querySelectorAll(".note-button"),c=Object(o.a)(a);try{for(c.s();!(n=c.n()).done;){var i=n.value;i.style.opacity===r&&(i.style.opacity="0")}}catch(s){c.e(s)}finally{c.f()}}}).then((function(e){if(de)he(de);else{var t=document.getElementById("screenshotHandler");t.innerHTML="",t.appendChild(e)}pe(!0)}))},className:"ui label",children:"ghost"}),Object(m.jsx)("button",{onClick:function(){return pe(!ve)},className:"ui label",children:ve?"hide":"show"})]}),Object(m.jsxs)("div",{className:"tools",children:[Object(m.jsx)("button",{onClick:Ne,title:"play",className:"ui",children:">"}),Object(m.jsx)("button",{onClick:Ae,title:"stop",className:"ui",style:{fontSize:20},children:"#"}),Object(m.jsx)("button",{onClick:function(){q<=0||(ae(!1),I(q-K),_(!$))},title:"up",className:"ui",children:"\u25b2"}),Object(m.jsx)("button",{title:"page",className:"ui",children:q/K}),Object(m.jsx)("button",{title:"down",onClick:function(e){ae(!1),I(K+q),_(!$)},className:"ui",children:"\u25bc"}),Object(m.jsx)("button",{title:"erase",className:"ui",onClick:function(){return f(),X({}),I(0),ae(!1),_(!$),void history.replaceState({},null,"/")},children:"x"}),Object(m.jsx)("input",{onInput:function(e){e.target.value.includes("sheet")&&Se(JSON.parse(e.target.value))},onKeyPress:function(e){switch(e.preventDefault(),e.stopPropagation(),e.key.toLowerCase()){case"w":if(q<=0)return;ae(!1),I(q-K),_(!$);break;case"s":ae(!1),I(K+q),_(!$);break;case"a":N(k-1);break;case"d":N(k+1);break;case"e":Ne();break;case"q":Ae();break;case"enter":e.target.value.includes("sheet")&&Se(JSON.parse(e.target.value))}},title:"title",onChange:function(e){return oe(e.target.value)},value:se,className:"ui title"})]})]}),Object(m.jsx)("div",{id:"screenshotHandler",style:{position:"absolute",display:ve?"block":"none"}}),ne&&Object(m.jsx)("div",{className:"matrix ".concat(re?"blured":""),style:{gridTemplateColumns:"auto ".repeat(l)},children:(xe=n,ge=l,Ce=null,Array(xe).fill(Ce).map((function(e){return Array(ge).fill(Ce)}))).map((function(e,t){return e.map((function(e,a){return Object(m.jsx)(v,{i:t+q,j:a-k,note:D[a-k+g],sound:j,sheet:V,speed:G,mod:n,volume:B},t+"-"+(a-k))}))}))})]})},y=function(){return Object(m.jsx)("div",{className:"App",children:Object(m.jsx)(p,{})})};s.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(y,{})}),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.794ef4a3.chunk.js.map