(this["webpackJsonpbleep-bloop"]=this["webpackJsonpbleep-bloop"]||[]).push([[0],{16:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var a=n(4),c=n.n(a),i=n(10),o=n.n(i),s=(n(16),n(2)),u=n(1),l=n(8),r="0.2",b=100,j=new l.a(l.b,{envelope:{releaseCurve:"sine"}}).toDestination();l.c.lookAhead=.2;var f=function(){for(var e=window.setTimeout((function(){}),0);e--;)window.clearTimeout(e)},d=new Map,h=["A0","B0","C1","D1","E1","F1","G1","A1","B1","C2","D2","E2","F2","G2","A2","B2","C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","B4","C5","D5","E5","F5","G5","A5","B5","C6","A6","B6","C7","D7","E7","F7","G7","A7","B7","B8"],O=n(11),m=n(3),v=function(e){var t=e.i,n=e.j,c=e.note,i=e.sound,o=e.sheet,s=e.mod,l=e.volume,b=e.speed,j="".concat(t,":").concat(n),f=o[j]||null,h=f?o[j]:{delay:.1,x:t,y:n},O=h.delay,v=h.delay>.1?h.delay+1:1,p=Object(a.useState)(f?"1":r),y=Object(u.a)(p,2),x=y[0],g=y[1],C=Object(a.useState)("#"+function(e){var t=(16777215&e).toString(16).toUpperCase();return"000000".substring(0,6-t.length)+t}(function(e){for(var t=0,n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return t}(c+"1230"))),w=Object(u.a)(C,1)[0];return f&&(o[j]=h,o[j].value=c),Object(m.jsx)("button",{style:{opacity:x},ref:function(e){null!==e&&t<s&&d.set(j,e)},className:"note-button",id:j,title:c,onClick:function(){var e="".concat(t,":").concat(n);o[e]?(g(r),delete o[e]):(g("1"),i.volume.value=l-30,i.triggerAttackRelease(c,O*b),o[e]={value:c,delay:O,x:t,y:n})},children:Object(m.jsx)("div",{style:{transform:"scale(1, ".concat(v,")"),backgroundColor:w},className:"shape"})})},p=function(){var e,t,n,c=Object(a.useState)(15),i=Object(u.a)(c,2),o=i[0],l=i[1],p=Object(a.useState)(30),y=Object(u.a)(p,2),x=y[0],g=y[1],C=Object(a.useState)(15),w=Object(u.a)(C,2),S=w[0],k=w[1],N=Object(a.useState)(0),A=Object(u.a)(N,2),E=A[0],B=A[1],T=Object(a.useState)(30),M=Object(u.a)(T,2),D=M[0],z=M[1],L=Object(a.useState)(h),F=Object(u.a)(L,1)[0],G=Object(a.useState)(.25),H=Object(u.a)(G,2),J=H[0],q=H[1],I=Object(a.useState)(0),R=Object(u.a)(I,2),P=R[0],U=R[1],W=Object(a.useState)(15),K=Object(u.a)(W,2),Q=K[0],V=K[1],X=Object(a.useState)({}),Y=Object(u.a)(X,2),Z=Y[0],$=Y[1],_=Object(a.useState)(!0),ee=Object(u.a)(_,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(!1),ce=Object(u.a)(ae,2),ie=ce[0],oe=ce[1],se=Object(a.useState)(""),ue=Object(u.a)(se,2),le=ue[0],re=ue[1],be=Object(a.useState)(!1),je=Object(u.a)(be,2),fe=je[0],de=je[1],he=Object(a.useState)(),Oe=Object(u.a)(he,2),me=Oe[0],ve=Oe[1],pe=Object(a.useState)(!1),ye=Object(u.a)(pe,2),xe=ye[0],ge=ye[1],Ce=function(e){var t=Object(a.useState)(e),n=Object(u.a)(t,2),c=n[0],i=n[1];return Object(a.useLayoutEffect)((function(){var e=function(){i({w:Math.floor(window.innerWidth/50),h:Math.floor(window.innerHeight/45)})};return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),c}({w:x,h:o}),we=function(e){ke();var t=Math.floor(Object.values(e).reduce((function(e,t){return Math.max(e,t.x)}),0)/o);!function e(n){oe(!1),n<=t?(U(Q*n),setTimeout((function(){return e(++n)}),150)):U(0),oe(!0)}(0)},Se=function e(){var t=-1/0;setTimeout((function(){Q!==o&&V(o),f();for(var n=Object.values(Z).map((function(e){var n=e.x,a=e.y,c=d.get("".concat((n+P)%o,":").concat(a));return c&&(c.style.opacity=r,c.firstChild.style.transform="scale(1)"),t=Math.max(t,n),{note:e,element:c,index:n}})),a=0;a<t;a++)n[a]||(n[a]={note:null,element:null,index:a});re(JSON.stringify({sheet:Z,offset:S,speed:J,shift:E})),n.forEach((function(n){var a=n.note,c=n.element,i=n.index;return a&&setTimeout((function(){var n=a.value,o=a.delay;j.volume.value=D-30,j.triggerAttackRelease(n,Math.max(o*J,.1)),c&&(c.style.opacity="1"),setTimeout((function(){c&&setTimeout((function(){c.style.opacity=r,c.firstChild.style.transform="scale(1)"}),(J*o+1)*b+b),i===t&&setTimeout((function(){return e()}),1e3)}),(J*o+1)*b)}),J*i*1e3+200)}))}),b*(0===P?1:5))},ke=function(){oe(!1),f(),ne(!te)};return Object(a.useEffect)((function(){var e=function(e){switch(e.preventDefault(),e.stopPropagation(),e.key.toLowerCase()){case"w":if(P<=0)return;oe(!1),U(P-Q),oe(!0);break;case"s":oe(!1),U(Q+P),oe(!0);break;case"a":B(E-1);break;case"d":B(E+1);break;case"e":0!==P?(oe(!1),U(0),oe(!0)):Se();break;case"q":oe(!1),f(),oe(!0)}};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[E,P]),Object(a.useEffect)((function(){oe(!1),g(Ce.w),l(Ce.h),oe(!0)}),[Ce.w,Ce.h]),Object(a.useEffect)((function(){return oe(!0)}),[te]),Object(m.jsxs)("div",{children:[Object(m.jsxs)("div",{className:"options  ".concat(fe?"blured":""),children:[Object(m.jsxs)("div",{className:"menu",children:[Object(m.jsx)("button",{className:"ui label",title:"shift right",onClick:function(){B(E+1)},children:">>"}),Object(m.jsx)("input",{className:"ui",onChange:function(e){return B(+e.target.value||0)},title:"shift",value:E,min:-h.length,max:h.length,style:{width:25,textAlign:"center",fontSize:10}}),Object(m.jsx)("button",{className:"ui label",title:"shift left",onClick:function(){return B(E-1)},children:"<<"}),Object(m.jsx)("input",{title:"offset",className:"ui",onChange:function(e){var t=+e.target.value;k(t),oe(!1),we(Z),ne(!te)},value:S,type:"number",min:0,max:h.length,style:{width:40,textAlign:"center",fontSize:10}}),Object(m.jsx)("input",{className:"ui",title:"change speed",onChange:function(e){return q(+e.target.value)},step:"0.1",type:"number",style:{width:80,fontSize:10,textAlign:"center"},value:J}),Object(m.jsx)("input",{className:"ui",onChange:function(e){var t=+e.target.value;t>=0&&t<=100&&function(e){z(e)}(t)},title:"volume",value:D,type:"number",min:0,max:100,style:{width:50,textAlign:"center",fontSize:10}}),Object(m.jsx)("button",{onClick:function(){ge(!1),O(document.querySelector(".matrix"),{backgroundColor:"transparent",canvas:me,onclone:function(e,t){var n,a=t.querySelectorAll(".note-button"),c=Object(s.a)(a);try{for(c.s();!(n=c.n()).done;){var i=n.value;i.style.opacity===r&&(i.style.opacity="0")}}catch(o){c.e(o)}finally{c.f()}}}).then((function(e){if(me)ve(me);else{var t=document.getElementById("screenshotHandler");t.innerHTML="",t.appendChild(e)}ge(!0)}))},className:"ui label",children:"ghost"}),Object(m.jsx)("button",{onClick:function(){return ge(!xe)},className:"ui label",children:xe?"hide":"show"})]}),Object(m.jsxs)("div",{className:"tools",children:[Object(m.jsx)("button",{onClick:function(){0!==P?(U(0),oe(!1),ne(!te)):Se()},title:"play",className:"ui",children:">"}),Object(m.jsx)("button",{onClick:ke,title:"stop",className:"ui",style:{fontSize:20},children:"#"}),Object(m.jsx)("button",{onClick:function(){P<=0||(oe(!1),U(P-Q),ne(!te))},title:"up",className:"ui",children:"\u25b2"}),Object(m.jsx)("button",{title:"page",className:"ui",children:P/Q}),Object(m.jsx)("button",{title:"down",onClick:function(e){oe(!1),U(Q+P),ne(!te)},className:"ui",children:"\u25bc"}),Object(m.jsx)("button",{title:"erase",className:"ui",onClick:function(){return f(),$({}),U(0),oe(!1),ne(!te),void history.replaceState({},null,"/")},children:"x"}),Object(m.jsx)("input",{title:"title",onChange:function(e){var t;e.target.value.includes("sheet")&&(re(e.target.value),t=JSON.parse(e.target.value),oe(!1),q(t.speed),k(t.offset),B(t.shift),$(t.sheet),de(!1),we(t.sheet))},value:le,className:"ui title"})]})]}),Object(m.jsx)("div",{id:"screenshotHandler",style:{position:"absolute",display:xe?"block":"none"}}),ie&&Object(m.jsx)("div",{className:"matrix ".concat(fe?"blured":""),style:{gridTemplateColumns:"auto ".repeat(x)},children:(e=o,t=x,n=null,Array(e).fill(n).map((function(e){return Array(t).fill(n)}))).map((function(e,t){return e.map((function(e,n){return Object(m.jsx)(v,{i:t+P,j:n-E,note:F[n-E+S],sound:j,sheet:Z,speed:J,mod:o,volume:D},t+"-"+(n-E))}))}))})]})},y=function(){return Object(m.jsx)("div",{className:"App",children:Object(m.jsx)(p,{})})};o.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(y,{})}),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.a03e99d5.chunk.js.map